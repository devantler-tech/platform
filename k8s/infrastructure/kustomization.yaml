apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - configmaps/oauth2-proxy-configmap.yaml
  - https://github.com/devantler/oci-artifacts//k8s/cert-manager?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/cloudflared?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/goldilocks?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/homepage?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/kubelet-serving-cert-approver?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/metrics-server?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/oauth2-proxy?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/openebs?ref=v0.0.5
  - https://github.com/devantler/oci-artifacts//k8s/traefik?ref=v0.0.5
  - ingresses/cilium-hubble-ingress.yaml

patches:
  - path: patches/goldilocks-patch.yaml
    target:
      kind: HelmRelease
      name: goldilocks
      namespace: goldilocks
  - path: patches/homepage-patch.yaml
    target:
      kind: HelmRelease
      name: homepage
      namespace: homepage
  - path: patches/traefik-patch.yaml
    target:
      kind: HelmRelease
      name: traefik
      namespace: traefik
  - path: patches/vpa-enable-patch.yaml
    target:
      kind: Namespace
      name: flux-system
  - path: patches/vpa-enable-patch.yaml
    target:
      kind: Namespace
      name: kube-system
