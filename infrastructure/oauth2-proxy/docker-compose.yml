networks:
  internal:
    external: true

services:
  oauth2-proxy:
    image: quay.io/oauth2-proxy/oauth2-proxy:v7.4.0
    environment:
        OAUTH2_PROXY_PROVIDER: keycloak-oidc
        OAUTH2_PROXY_CLIENT_ID: ${OAUTH2_PROXY_CLIENT_ID?}
        OAUTH2_PROXY_CLIENT_SECRET: ${OAUTH2_PROXY_CLIENT_SECRET?}
        OAUTH2_PROXY_REDIRECT_URL: https://${DOMAIN?}/oauth2/callback
        OAUTH2_PROXY_OIDC_ISSUER_URL: https://auth.${DOMAIN?}/realms/master
    networks:
      - internal
      