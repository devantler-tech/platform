- name: Create /etc/nomad.d/config directory
  file:
    path: /etc/nomad.d/config
    state: directory

- name: Add Nomad Configuration
  template:
    src: nomad.hcl
    dest: /etc/nomad.d/nomad.hcl
    owner: root
    group: root
    mode: 0644

- name: Create nomad.service
  template:
    src: nomad.service
    dest: /etc/systemd/system/nomad.service
    owner: root
    group: root
    mode: 0644

- name: Start nomad.service
  service:
    name: nomad
    state: started
    enabled: true