- name: Installing Longhorn requirements
  ansible.builtin.apt:
    pkg:
    - nfs-common
    - open-iscsi
  
- name: Removing nfs-common.service file
  file:
    path: /lib/systemd/system/nfs-common.service
    state: absent

- name: Reloading systemd
  systemd:
    name: reload
    daemon_reload: true

- name: Starting nfs-common service
  systemd:
    name: nfs-common
    state: started
    enabled: yes

- name: Starting open-iscsi service
  systemd:
    name: open-iscsi
    state: started
    enabled: yes