networks:
  internal:
    external: true
  public:
    external: true
services:
  energy-sector-dp:
    image: ghcr.io/devantler/data-product:v0.0.14
    networks:
      - internal
      - public
    environment:
      NAME: Energy Sector Data Product
      DESCRIPTION: A data product to query and manage energy sector data
      RELEASE: v0.0.1
      PUBLICURL: https://energy-sector-dp.${DOMAIN?}
      LICENSE__NAME: MIT
      LICENSE__URL: https://opensource.org/licenses/MIT
      OWNER__NAME: ${OWNER_NAME?}
      OWNER__EMAIL: ${OWNER_EMAIL?}
      OWNER__ORGANISATION: ${OWNER_ORGANISATION?}
      OWNER__PHONE: ${OWNER_PHONE?}
      OWNER__WEBSITE: ${OWNER_WEBSITE?}
      DASHBOARD__LINKS__0__NAME: Kafka
      DASHBOARD__LINKS__0__URL: https://kafka-ui.devantler.com/
      DASHBOARD__LINKS__1__NAME: pgweb
      DASHBOARD__LINKS__1__URL: https://pgweb.devantler.com/
      DASHBOARD__LINKS__2__NAME: DataHub
      DASHBOARD__LINKS__2__URL: https://datahub.devantler.com/
      DASHBOARD__LINKS__3__NAME: Jaeger
      DASHBOARD__LINKS__3__URL: https://jaeger.devantler.com/
      DATASTORE__TYPE: SQL
      DATASTORE__PROVIDER: PostgreSQL
      DATASTORE__CONNECTIONSTRING: Host=postgres;Port=5432;Database=energy-sector;Username=postgres;Password=${POSTGRES_PASSWORD?}
      CACHESTORE__TYPE: InMemory
      SCHEMAREGISTRY__TYPE: Kafka
      SCHEMAREGISTRY__URL: https://schema-registry.devantler.com
      SCHEMAREGISTRY__SCHEMA__SUBJECT: energy-sector-value
      SCHEMAREGISTRY__SCHEMA__VERSION: 1
      DATACATALOG__TYPE: DataHub
      DATACATALOG__URL: https://datahub.devantler.com
      DATACATALOG__ACCESSTOKEN: ${DATACATALOG_ACCESSTOKEN?}
      DATAINGESTORS__0__TYPE: Kafka
      DATAINGESTORS__0__GROUPID: energy-sector
      DATAINGESTORS__0__TOPIC: energy-sector
      DATAINGESTORS__0__SERVERS: kafka:9092
      METRICSSYSTEM__TYPE: OpenTelemetry
      METRICSSYSTEM__ENDPOINT: http://prometheus:9090
      TRACINGSYSTEM__TYPE: OpenTelemetry
      TRACINGSYSTEM__ENDPOINT: http://jaeger:4317
      FEATUREFLAGS__ENABLEDASHBOARD: true
      FEATUREFLAGS__ENABLEAPIS__0: Rest
      FEATUREFLAGS__ENABLEAPIS__1: GraphQL
      FEATUREFLAGS__ENABLECACHING: true
      FEATUREFLAGS__ENABLEDATACATALOG: true
      FEATUREFLAGS__ENABLEDATAINGESTION: true
      FEATUREFLAGS__ENABLEDATAEGESTION: false
      FEATUREFLAGS__ENABLETRACING: true
      FEATUREFLAGS__ENABLEMETRICS: true
      FEATUREFLAGS__ENABLEAUTHENTICATION: false
      FEATUREFLAGS__ENABLEAUTHORISATION: false
      FEATUREFLAGS__ENABLEWEBHOOKS: false
    labels:
      traefik.enable: true
      traefik.http.routers.energy-sector-dp.entrypoints: ${TRAEFIK_ENTRYPOINTS?}
      traefik.http.routers.energy-sector-dp.rule: Host(`energy-sector-dp.${DOMAIN?}`)
    restart: unless-stopped
