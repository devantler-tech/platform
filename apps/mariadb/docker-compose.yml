networks:
  internal:
    external: true
  traefik:
    external: true
services:
  mariadb:
    environment:
      MARIADB_MYSQL_LOCALHOST_USER: true
      MARIADB_PASSWORD: ${PASSWORD?}
      MARIADB_ROOT_PASSWORD: ${ROOT_PASSWORD?}
      MARIADB_USER: ${USER?}
    healthcheck:
      test: /usr/local/bin/healthcheck.sh --su-mysql --connect --innodb_initialized
    image: mariadb:10.9.5
    labels:
      traefik.enable: true
      traefik.tcp.routers.mariadb.entrypoints: mariadb
      traefik.tcp.routers.mariadb.rule: HostSNI(`*`)
    networks:
      - internal
      - traefik
    volumes:
      - mariadb-mysql:/var/lib/mysql
volumes:
  mariadb-mysql: null
